
====================================================================================================
PHASE 5 MODEL BENCHMARK
====================================================================================================

Configurations to test:
  â€¢ Base (4-bit): Qwen2.5-Coder-7B-Instruct-4bit (no fine-tuning)
  â€¢ Phase 5 Adapter: Base + LoRA adapters (244 examples)
  â€¢ Phase 5 Fused (float16): LoRA merged to full precision float16
  â€¢ Phase 5 Fused (8-bit): LoRA merged + quantized to 8-bit

Metrics:
  â€¢ Speed: Load time + generation time per query
  â€¢ Memory: Disk size + peak runtime memory
  â€¢ Quality: Discrimination accuracy (tool vs direct answer)

================================================================================
Benchmarking: Base (4-bit)
Description: Qwen2.5-Coder-7B-Instruct-4bit (no fine-tuning)
Model path: mlx-community/Qwen2.5-Coder-7B-Instruct-4bit
================================================================================

Loading model...
Fetching 9 files:   0%|          | 0/9 [00:00<?, ?it/s]Fetching 9 files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:00<00:00, 22402.81it/s]
mx.metal.get_active_memory is deprecated and will be removed in a future version. Use mx.get_active_memory instead.
âœ“ Model loaded in 1.36s
Running warm-up query...
âœ“ Warm-up complete


1. Concept question - should give direct answer
   Query: "What is dependency injection?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 38.74s, Length: 1487 chars
   Response: Dependency injection (DI) is a design pattern in software engineering that allows for the separation...

2. Comparison question - should give direct answer
   Query: "What is the difference between a Registry and a Container?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 35.07s, Length: 1401 chars
   Response: In the context of software development and containerization, a Registry and a Container are two dist...

3. Search query - should use tool
   Query: "Find all classes that inherit from Protocol"
   âŒ Expected: TOOL, Actual: DIRECT
   Time: 38.31s, Length: 1432 chars
   Response: In Python, the `Protocol` class is part of the `typing` module and is used to define structural type...

4. Read file query - should use tool
   Query: "Show me the basic injection example"
   âŒ Expected: TOOL, Actual: DIRECT
   Time: 38.57s, Length: 1319 chars
   Response: Certainly! Injection attacks can occur in various contexts, such as SQL injection, command injection...

5. Best practice question - should give direct answer
   Query: "When should I use svcs vs a DI framework?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 42.33s, Length: 1476 chars
   Response: Choosing between using `svcs` and a Dependency Injection (DI) framework in Python depends on your sp...

================================================================================
Benchmarking: Phase 5 Adapter
Description: Base + LoRA adapters (244 examples)
Model path: mlx-community/Qwen2.5-Coder-7B-Instruct-4bit
Adapter: ./adapters
================================================================================

Disk size: 0.39 GB
Loading model...
Fetching 9 files:   0%|          | 0/9 [00:00<?, ?it/s]Fetching 9 files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:00<00:00, 15202.87it/s]
âœ“ Model loaded in 1.15s
Running warm-up query...
âœ“ Warm-up complete


1. Concept question - should give direct answer
   Query: "What is dependency injection?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 40.73s, Length: 1546 chars
   Response: Dependency injection means the service layer is called with all services it needs to do its job. Ins...

2. Comparison question - should give direct answer
   Query: "What is the difference between a Registry and a Container?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 41.52s, Length: 1739 chars
   Response: Registry is application-scoped and stores factory functions and value services - it lives for the en...

3. Search query - should use tool
   Query: "Find all classes that inherit from Protocol"
   âœ… Expected: TOOL, Actual: TOOL
   Time: 41.53s, Length: 1230 chars
   Response: I'll use the run_command tool.

```json
{
  "name": "run_command",
  "arguments": {"command": "grep ...

4. Read file query - should use tool
   Query: "Show me the basic injection example"
   âœ… Expected: TOOL, Actual: TOOL
   Time: 45.01s, Length: 1356 chars
   Response: I'll use the read_file tool.

```json
{
  "name": "read_file",
  "arguments": {
    "path": "svcs-di...

5. Best practice question - should give direct answer
   Query: "When should I use svcs vs a DI framework?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 437.46s, Length: 1572 chars
   Response: Use svcs when you want late binding, imperative service acquisition, and the flexibility to acquire ...

================================================================================
Benchmarking: Phase 5 Fused (float16)
Description: LoRA merged to full precision float16
Model path: ./fused_model_f16
================================================================================

Disk size: 14.20 GB
Loading model...
âœ“ Model loaded in 6.24s
Running warm-up query...
âœ“ Warm-up complete


1. Concept question - should give direct answer
   Query: "What is dependency injection?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 78.82s, Length: 1546 chars
   Response: Dependency injection means the service layer is called with all services it needs to do its job. Ins...

2. Comparison question - should give direct answer
   Query: "What is the difference between a Registry and a Container?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 66.74s, Length: 1739 chars
   Response: Registry is application-scoped and stores factory functions and value services - it lives for the en...

3. Search query - should use tool
   Query: "Find all classes that inherit from Protocol"
   âœ… Expected: TOOL, Actual: TOOL
   Time: 25.89s, Length: 1230 chars
   Response: I'll use the run_command tool.

```json
{
  "name": "run_command",
  "arguments": {"command": "grep ...

4. Read file query - should use tool
   Query: "Show me the basic injection example"
   âœ… Expected: TOOL, Actual: TOOL
   Time: 25.85s, Length: 1356 chars
   Response: I'll use the read_file tool.

```json
{
  "name": "read_file",
  "arguments": {
    "path": "svcs-di...

5. Best practice question - should give direct answer
   Query: "When should I use svcs vs a DI framework?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 25.79s, Length: 1572 chars
   Response: Use svcs when you want late binding, imperative service acquisition, and the flexibility to acquire ...

================================================================================
Benchmarking: Phase 5 Fused (8-bit)
Description: LoRA merged + quantized to 8-bit
Model path: ./fused_model_8bit
================================================================================

Disk size: 7.55 GB
Loading model...
âœ“ Model loaded in 4.28s
Running warm-up query...
âœ“ Warm-up complete


1. Concept question - should give direct answer
   Query: "What is dependency injection?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 14.39s, Length: 1536 chars
   Response: Dependency injection means the service layer is called with all services it needs to do its job. Ins...

2. Comparison question - should give direct answer
   Query: "What is the difference between a Registry and a Container?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 14.19s, Length: 1733 chars
   Response: Registry is application-scoped and stores factory functions and value services - it lives for the en...

3. Search query - should use tool
   Query: "Find all classes that inherit from Protocol"
   âœ… Expected: TOOL, Actual: TOOL
   Time: 14.17s, Length: 1230 chars
   Response: I'll use the run_command tool.

```json
{
  "name": "run_command",
  "arguments": {"command": "grep ...

4. Read file query - should use tool
   Query: "Show me the basic injection example"
   âœ… Expected: TOOL, Actual: TOOL
   Time: 14.31s, Length: 1406 chars
   Response: I'll use the read_file tool.

```json
{
  "name": "read_file",
  "arguments": {
    "path": "svcs-di...

5. Best practice question - should give direct answer
   Query: "When should I use svcs vs a DI framework?"
   âœ… Expected: DIRECT, Actual: DIRECT
   Time: 14.29s, Length: 1579 chars
   Response: Use svcs when you want late binding, imperative service acquisition, and the flexibility to acquire ...

====================================================================================================
COMPARISON: Base (4-bit) vs. Phase 5 Adapter vs. Phase 5 Fused (float16) vs. Phase 5 Fused (8-bit)
====================================================================================================

ðŸ“Š SPEED
----------------------------------------------------------------------------------------------------
Metric                    Base (4-bit)    Phase 5 Adapter Phase 5 Fused (float16) Phase 5 Fused (8-bit) Phase 5 Adapter vs Base Phase 5 Fused (float16) vs Base Phase 5 Fused (8-bit) vs Base
----------------------------------------------------------------------------------------------------
Load Time                   1.36s           1.15s           6.24s           4.28s         -0.21s (-16%)      +4.88s (+360%)      +2.92s (+215%)     
Avg Generation Time        38.60s         121.25s          44.62s          14.27s         +82.65s (+214%)      +6.01s (+16%)      -24.33s (-63%)     
Total Generation Time     193.02s         606.25s         223.09s          71.35s         +413.23s (+214%)      +30.07s (+16%)      -121.67s (-63%)     

ðŸ’¾ MEMORY
----------------------------------------------------------------------------------------------------
Metric                    Base (4-bit)    Phase 5 Adapter Phase 5 Fused (float16) Phase 5 Fused (8-bit) Phase 5 Adapter vs Base Phase 5 Fused (float16) vs Base Phase 5 Fused (8-bit) vs Base
----------------------------------------------------------------------------------------------------
Disk Size                 N/A               0.39 GB        14.20 GB         7.55 GB       N/A                  N/A                  N/A                 
Peak Memory                 3.99 GB         4.04 GB        14.19 GB         7.54 GB       +0.04 GB (+1%)      +10.19 GB (+255%)      +3.55 GB (+89%)     

ðŸŽ¯ QUALITY
----------------------------------------------------------------------------------------------------
Metric                    Base (4-bit)    Phase 5 Adapter Phase 5 Fused (float16) Phase 5 Fused (8-bit) Phase 5 Adapter vs Base Phase 5 Fused (float16) vs Base Phase 5 Fused (8-bit) vs Base
----------------------------------------------------------------------------------------------------
Discrimination Accuracy   3/5 ( 60.0%)   5/5 (100.0%)   5/5 (100.0%)   5/5 (100.0%)   +40.0pp                +40.0pp                +40.0pp               

ðŸ“‹ PER-QUERY COMPARISON
----------------------------------------------------------------------------------------------------
Query           Base (4-bi   Phase 5 Ad   Phase 5 Fu   Phase 5 Fu   Base (4-bi Time Phase 5 Ad Time Phase 5 Fu Time Phase 5 Fu Time
----------------------------------------------------------------------------------------------------
concept         âœ… dire   âœ… dire   âœ… dire   âœ… dire   38.74s      40.73s      78.82s      14.39s     
comparison      âœ… dire   âœ… dire   âœ… dire   âœ… dire   35.07s      41.52s      66.74s      14.19s     
search          âŒ dire   âœ… tool   âœ… tool   âœ… tool   38.31s      41.53s      25.89s      14.17s     
read            âŒ dire   âœ… tool   âœ… tool   âœ… tool   38.57s      45.01s      25.85s      14.31s     
best_practice   âœ… dire   âœ… dire   âœ… dire   âœ… dire   42.33s      437.46s      25.79s      14.29s     

====================================================================================================
VERDICT
====================================================================================================

Phase 5 Adapter:
  ðŸŽ¯ Quality: âœ… BETTER (+40.0pp)
  âš¡ Speed: âš ï¸  SLOWER (+214.1%)
  ðŸ’¾ Memory: âž¡ï¸  SIMILAR (Â±1.1%)

Phase 5 Fused (float16):
  ðŸŽ¯ Quality: âœ… BETTER (+40.0pp)
  âš¡ Speed: âš ï¸  SLOWER (+15.6%)
  ðŸ’¾ Memory: âš ï¸  MORE (+255.2%)

Phase 5 Fused (8-bit):
  ðŸŽ¯ Quality: âœ… BETTER (+40.0pp)
  âš¡ Speed: âœ… FASTER (-63.0%)
  ðŸ’¾ Memory: âš ï¸  MORE (+88.8%)

ðŸ’¡ OVERALL RECOMMENDATION:
  âœ… WINNER: Phase 5 Fused (8-bit)
     â€¢ Same quality as others (100.0% accuracy)
     â€¢ Fastest among top performers (14.27s avg)
     â€¢ Disk size: 7.55 GB

====================================================================================================
